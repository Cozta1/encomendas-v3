@use '@angular/material' as mat;
@include mat.core();

// 1. Define a paleta de cores do TEMA CLARO (Padrão)
$light-primary: mat.m2-define-palette(mat.$m2-indigo-palette, A400, A100, A700);
$light-accent: mat.m2-define-palette(mat.$m2-pink-palette, A200, A100, A400);
$light-warn: mat.m2-define-palette(mat.$m2-red-palette);

$light-theme: mat.m2-define-light-theme((
  color: (
    primary: $light-primary,
    accent: $light-accent,
    warn: $light-warn,
  )
));

// 2. Define a paleta de cores do TEMA ESCURO
$dark-primary: mat.m2-define-palette(mat.$m2-indigo-palette, A200, A100, A400); // Trocado para Indigo no dark
$dark-accent: mat.m2-define-palette(mat.$m2-pink-palette, A200, A100, A400);
$dark-warn: mat.m2-define-palette(mat.$m2-red-palette);

$dark-theme: mat.m2-define-dark-theme((
  color: (
    primary: $dark-primary,
    accent: $dark-accent,
    warn: $dark-warn,
  )
));

// 3. APLICA O TEMA CLARO como padrão (componentes Material)
@include mat.all-component-themes($light-theme);

// 4. APLICA O TEMA ESCURO (componentes Material)
.dark-theme {
  @include mat.all-component-colors($dark-theme);
}

// 5. DEFINIÇÃO DAS VARIÁVEIS DE CSS GLOBAIS

// Variáveis para o TEMA CLARO (Padrão)
:root {
  // Cores da Paleta
  --app-primary-color: #{mat.m2-get-color-from-palette($light-primary, 'A400')};
  --app-accent-color: #{mat.m2-get-color-from-palette($light-accent, 'A200')};
  --app-warn-color: #{mat.m2-get-color-from-palette($light-warn, 'default')};

  // Cores de Fundo
  --app-background-color: #f5f5f5;
  --app-card-background-color: #ffffff;
  --app-sidebar-background-color: #fafafa;
  --app-surface-color: #f0f0f0;
  --app-border-color: rgba(0, 0, 0, 0.12);
  --app-divider-color: #e0e0e0;

  // Cores de Texto
  --app-text-color: rgba(0, 0, 0, 0.87);
  --app-text-color-secondary: rgba(0, 0, 0, 0.6);
  --app-text-muted: #9e9e9e;

  // Interação
  --app-hover-bg: rgba(0, 0, 0, 0.04);

  // Cores do Chip Cancelado
  --app-chip-cancelado-bg: #e0e0e0;
  --app-chip-cancelado-text: #616161;
}

// Variáveis para o TEMA ESCURO — estilo Opera GX Force Dark
.dark-theme {
  // Cores da Paleta
  --app-primary-color: #{mat.m2-get-color-from-palette($dark-primary, 'A200')};
  --app-accent-color: #{mat.m2-get-color-from-palette($dark-accent, 'A200')};
  --app-warn-color: #{mat.m2-get-color-from-palette($dark-warn, 'default')};

  // Cores de Fundo (Opera GX force-dark)
  --app-background-color: #141414;      // Quase preto — fundo da página
  --app-card-background-color: #1e1e1e; // Superfície dos cards/dialogs
  --app-sidebar-background-color: #111111; // Sidebar ainda mais escura
  --app-surface-color: #252525;         // Superfície elevada (dentro de cards)
  --app-border-color: rgba(255, 255, 255, 0.07);
  --app-divider-color: #2a2a2a;

  // Cores de Texto
  --app-text-color: #e8e8e8;            // Branco suave
  --app-text-color-secondary: #9a9a9a; // Cinza médio
  --app-text-muted: #555555;           // Cinza escuro

  // Interação
  --app-hover-bg: rgba(255, 255, 255, 0.05);

  // Cores do Chip Cancelado
  --app-chip-cancelado-bg: #272727;
  --app-chip-cancelado-text: #9a9a9a;
}

// Resets globais e aplicação das variáveis
html, body {
  height: 100%;
}

body {
  margin: 0;
  font-family: Roboto, "Helvetica Neue", sans-serif;
  // Aplica as variáveis de fundo e texto ao body
  background-color: var(--app-background-color);
  color: var(--app-text-color);
}

// Estilo global do chip cancelado
.chip-cancelado {
  background-color: var(--app-chip-cancelado-bg) !important;
  color: var(--app-chip-cancelado-text) !important;
}


// Scrollbars globais no modo escuro
.dark-theme {
  * {
    scrollbar-color: #333 #1a1a1a;
    scrollbar-width: thin;
  }
  *::-webkit-scrollbar { width: 8px; height: 8px; }
  *::-webkit-scrollbar-track { background: #1a1a1a; }
  *::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
  *::-webkit-scrollbar-thumb:hover { background: #444; }
}

/* --- Estilos Responsivos Globais --- */

/* 1. Responsividade para Tabelas
   Faz com que o container da tabela tenha scroll horizontal em telas pequenas.
   Pode ser aplicado no 'mat-card-content' das páginas.
*/
.mat-mdc-card-content {
  overflow-x: auto;
}

/* 2. Ajuste para Diálogos em Mobile
   Sobrescreve a largura fixa se a tela for pequena.
*/
.cdk-overlay-pane {
  max-width: 95vw !important; /* Margem de segurança */
}

/* Em telas muito pequenas, o diálogo ocupa quase tudo */
@media (max-width: 600px) {
  .mat-mdc-dialog-container {
    padding: 12px !important;
  }
}

/* 3. Ajuste de Layout Principal */
.app-content {
  /* Em mobile, reduz o padding para ganhar espaço */
  @media (max-width: 600px) {
    .page-content {
      padding: 12px;
    }
  }
}

/* ===================== NOTIFICATION MENU PANEL ===================== */
/* mat-menu panels are rendered in <body>, so styles must be global. */

.notif-menu-panel {
  width: 360px !important;
  max-width: min(360px, calc(100vw - 16px)) !important;
  overflow-x: hidden !important;

  // Allow items to wrap text and grow in height
  .mat-mdc-menu-item {
    height: auto !important;
    min-height: 56px !important;
    padding-top: 6px !important;
    padding-bottom: 6px !important;
    white-space: normal !important;

    .mdc-list-item__primary-text {
      white-space: normal !important;
      width: 100% !important;
      overflow: hidden !important;
    }
  }
}

.dark-theme .notif-menu-panel {
  .notif-header { color: #e0e0e0; }
  .notif-body {
    .notif-titulo { color: #e0e0e0; }
    .notif-msg { color: #9a9a9a; }
  }
  .notif-nao-lida { background: rgba(144, 202, 249, 0.06) !important; }
  .notif-vazio { color: #555; }
}
